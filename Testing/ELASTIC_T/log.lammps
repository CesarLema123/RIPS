LAMMPS (8 Feb 2019)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:87)
  using 1 OpenMP thread(s) per MPI task
# Compute elastic constant tensor for a crystal at finite temperature
#
# WARNING: This script attempts to measure small differences in
# statistical averages generated by finite temperature MD simulations.
# This creates many more opportunities for errors to occur, compared
# to the zero temperature version provided in examples/ELASTIC.
# Hence, it is always a good idea to start with the zero temperature
# calculation, before attempting to use this script.
#
# Written by Aidan Thompson (Sandia, athomps@sandia.gov)
#
#  This script uses the following three include files.
#
#   init.mod      (must be modified for different crystal structures)
# 	       	  Define units, MD parameters, deformation parameters,
#		  and initial configuration of the atoms and simulation cell.
#
#
#   potential.mod    (must be modified for different pair styles)
# 		     Define pair style and other attributes
#		     not stored in restart file
#
#
#   displace.mod    (displace.mod should not need to be modified)
# 		    Perform positive and negative box displacements
# 		    in direction ${dir} and size ${up}.
# 		    It uses the resultant changes
#		    in stress to compute one
# 		    row of the elastic stiffness tensor
#
#		    Inputs variables:
#		    	   dir = the Voigt deformation component
#		    		    (1,2,3,4,5,6)
#		    Global constants:
#       	    	   up = the deformation magnitude (strain units)
#       		   cfac = conversion from LAMMPS pressure units to
#               	   output units for elastic constants
#
#
#  To run this on a different system, it should only be necessary to
#  modify the files init.mod and potential.mod. In order to calculate
#  the elastic constants correctly, care must be taken to specify
#  the correct units in init.mod (units, cfac and cunits). It is also
#  important to verify that the MD sampling of stress components
#  is generating accurate statistical averages.
#  One indication of this is that the elastic constants are insensitive
#  to the choice of the variable ${up} in init.mod. Another is to
#  check for finite size effects.
#

include init.mod
# NOTE: This script can be modified for different atomic structures,
# units, etc. See in.elastic for more info.
#

# Define the finite deformation size. Try several values of this
# variable to verify that results do not depend on it.
variable up equal 2.0e-2

# metal units, elastic constants in GPa
units		metal
variable cfac equal 1.0e-4
variable cunits string GPa

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
variable nequil equal 10*${nthermo}       # length of equilibration run
variable nequil equal 10*100       
variable nrun equal 3*${nthermo}          # length of equilibrated run
variable nrun equal 3*100          
variable TEMPERATURE equal 2000.0                # temperature of initial sample
variable TIMESTEP equal 0.001             # TIMESTEP
variable kT equal 10			# lammps manual suggests 100 but example set it to 10
variable tdamp equal ${kT}*${TIMESTEP}  # time constant for thermostat
variable tdamp equal 10*${TIMESTEP}  
variable tdamp equal 10*0.001  
variable RANDOM equal 123457                # seed for thermostat

# generate the box and atom positions
dimension 	3
boundary	p p p
atom_style 	atomic
read_data	data.elastic
  triclinic box = (0 0 0) to (28.8 28.8 28.8) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  2048 atoms
  reading velocities ...
  2048 velocities

# Compute initial state

include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0

# Choose potential
pair_style	eam/alloy
pair_coeff 	* * CuNi.eam.alloy Ni Cu
Reading potential file CuNi.eam.alloy with DATE: 2014-07-11


# Setup neighbor style

neighbor	0.5 bin
neigh_modify delay 10 check yes

# Setup output
variable energy equal etotal
variable volume equal vol
variable pxx2 equal "c_thermo_press[1]^2"
fix avp all ave/time ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time 10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time 10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time 10 10 100 c_thermo_press mode vector
fix avE all ave/time ${nevery} ${nrepeat} ${nfreq} v_energy mode scalar
fix avE all ave/time 10 ${nrepeat} ${nfreq} v_energy mode scalar
fix avE all ave/time 10 10 ${nfreq} v_energy mode scalar
fix avE all ave/time 10 10 100 v_energy mode scalar
fix avv all ave/time ${nevery} ${nrepeat} ${nfreq} v_volume mode scalar
fix avv all ave/time 10 ${nrepeat} ${nfreq} v_volume mode scalar
fix avv all ave/time 10 10 ${nfreq} v_volume mode scalar
fix avv all ave/time 10 10 100 v_volume mode scalar
fix avt all ave/time ${nevery} ${nrepeat} ${nfreq} c_thermo_temp mode scalar
fix avt all ave/time 10 ${nrepeat} ${nfreq} c_thermo_temp mode scalar
fix avt all ave/time 10 10 ${nfreq} c_thermo_temp mode scalar
fix avt all ave/time 10 10 100 c_thermo_temp mode scalar
fix avpxx2 all ave/time ${nevery} ${nrepeat} ${nfreq} v_pxx2 mode scalar
fix avpxx2 all ave/time 10 ${nrepeat} ${nfreq} v_pxx2 mode scalar
fix avpxx2 all ave/time 10 10 ${nfreq} v_pxx2 mode scalar
fix avpxx2 all ave/time 10 10 100 v_pxx2 mode scalar
thermo		${nthermo}
thermo		100
thermo_style custom step temp f_avt etotal f_avE vol f_avv press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] f_avpxx2
thermo_modify norm no

# Setup MD

timestep ${TIMESTEP}
timestep 0.001
fix 4 all nve
fix 5 all langevin ${TEMPERATURE} ${TEMPERATURE} ${tdamp} ${RANDOM}
fix 5 all langevin 2000 ${TEMPERATURE} ${tdamp} ${RANDOM}
fix 5 all langevin 2000 2000 ${tdamp} ${RANDOM}
fix 5 all langevin 2000 2000 0.01 ${RANDOM}
fix 5 all langevin 2000 2000 0.01 123457



run ${nequil}
run 1000
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.89433
  ghost atom cutoff = 6.89433
  binsize = 3.44717, bins = 9 9 9
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair eam/alloy, perpetual
      attributes: half, newton on
      pair build: half/bin/newton/tri
      stencil: half/bin/3d/newton/tri
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 3.547 | 3.547 | 3.547 Mbytes
Step Temp f_avt TotEng f_avE Volume f_avv Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] f_avpxx2 
       0            0            0   -7741.9764            0    23887.872            0    1457.5543            0            0            0            0            0            0            0 
     100    1977.7922    1906.2669   -6818.6545   -6973.0907    23887.872    23887.872    111113.81    81527.737     81329.56     82183.48   -807.06412   -12.654019    -215.4273 7.3692395e+09 
     200    1953.9033    1995.1603   -6761.3653   -6774.8823    23887.872    23887.872    123509.79     117768.2    120197.35    119252.82   -329.15912   -1250.1431    66.970373 1.3880106e+10 
     300    2025.7723    2022.4653   -6717.0587   -6723.4729    23887.872    23887.872    128601.78     126600.6    127123.22    129618.46   -71.751587   -910.17766    1129.5748 1.6036662e+10 
     400    2001.6944    1993.6406   -6711.0422   -6720.6194    23887.872    23887.872    131138.21    128153.83    130347.62    129755.78   -1245.0327   -64.234234   -393.26624 1.6425439e+10 
     500    1952.4304      2008.51   -6702.2078   -6695.1614    23887.872    23887.872    134460.61    133000.72    132809.03    134839.15   -2256.9703     257.6035   -822.84908 1.7690482e+10 
     600    1997.2122    1996.6973    -6696.285   -6692.2558    23887.872    23887.872    133574.89    133359.67    135249.31    134865.64    403.74535   -599.44506   -771.31128 1.7786495e+10 
     700    1945.3729    1997.7101    -6698.534   -6696.0011    23887.872    23887.872    135596.37    133230.04    133686.66       133675    1871.3918   -495.62988   -2380.5081 1.7752087e+10 
     800    1967.5514    1995.2634   -6685.8234   -6678.0774    23887.872    23887.872    137007.03    137599.06     136226.8    138097.47    918.47225    889.04223   -865.57229 1.8935779e+10 
     900    1963.3304    1979.4708   -6685.7961   -6692.6201    23887.872    23887.872    137112.27    133853.84    134398.17    137754.81    31.116661    599.09887    1996.5757 1.7921042e+10 
    1000    1998.4843    1999.9775   -6678.3317   -6672.4093    23887.872    23887.872    137357.09    134556.93    139984.23    139950.09   -929.94986   -272.08133    933.49748 1.810745e+10 
Loop time of 5.21604 on 1 procs for 1000 steps with 2048 atoms

Performance: 16.564 ns/day, 1.449 hours/ns, 191.717 timesteps/s
99.8% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.7684     | 4.7684     | 4.7684     |   0.0 | 91.42
Neigh   | 0.33125    | 0.33125    | 0.33125    |   0.0 |  6.35
Comm    | 0.020328   | 0.020328   | 0.020328   |   0.0 |  0.39
Output  | 0.00028064 | 0.00028064 | 0.00028064 |   0.0 |  0.01
Modify  | 0.088724   | 0.088724   | 0.088724   |   0.0 |  1.70
Other   |            | 0.007048   |            |       |  0.14

Nlocal:    2048 ave 2048 max 2048 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    4168 ave 4168 max 4168 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    123187 ave 123187 max 123187 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 123187
Ave neighs/atom = 60.1499
Neighbor list builds = 68
Dangerous builds = 0


include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0

# Choose potential
pair_style	eam/alloy
pair_coeff 	* * CuNi.eam.alloy Ni Cu
Reading potential file CuNi.eam.alloy with DATE: 2014-07-11


# Setup neighbor style

neighbor	0.5 bin
neigh_modify delay 10 check yes

# Setup output
variable energy equal etotal
variable volume equal vol
variable pxx2 equal "c_thermo_press[1]^2"
fix avp all ave/time ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time 10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time 10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time 10 10 100 c_thermo_press mode vector
fix avE all ave/time ${nevery} ${nrepeat} ${nfreq} v_energy mode scalar
fix avE all ave/time 10 ${nrepeat} ${nfreq} v_energy mode scalar
fix avE all ave/time 10 10 ${nfreq} v_energy mode scalar
fix avE all ave/time 10 10 100 v_energy mode scalar
fix avv all ave/time ${nevery} ${nrepeat} ${nfreq} v_volume mode scalar
fix avv all ave/time 10 ${nrepeat} ${nfreq} v_volume mode scalar
fix avv all ave/time 10 10 ${nfreq} v_volume mode scalar
fix avv all ave/time 10 10 100 v_volume mode scalar
fix avt all ave/time ${nevery} ${nrepeat} ${nfreq} c_thermo_temp mode scalar
fix avt all ave/time 10 ${nrepeat} ${nfreq} c_thermo_temp mode scalar
fix avt all ave/time 10 10 ${nfreq} c_thermo_temp mode scalar
fix avt all ave/time 10 10 100 c_thermo_temp mode scalar
fix avpxx2 all ave/time ${nevery} ${nrepeat} ${nfreq} v_pxx2 mode scalar
fix avpxx2 all ave/time 10 ${nrepeat} ${nfreq} v_pxx2 mode scalar
fix avpxx2 all ave/time 10 10 ${nfreq} v_pxx2 mode scalar
fix avpxx2 all ave/time 10 10 100 v_pxx2 mode scalar
thermo		${nthermo}
thermo		100
thermo_style custom step temp f_avt etotal f_avE vol f_avv press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] f_avpxx2
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:705)
thermo_modify norm no

# Setup MD

timestep ${TIMESTEP}
timestep 0.001
fix 4 all nve
fix 5 all langevin ${TEMPERATURE} ${TEMPERATURE} ${tdamp} ${RANDOM}
fix 5 all langevin 2000 ${TEMPERATURE} ${tdamp} ${RANDOM}
fix 5 all langevin 2000 2000 ${tdamp} ${RANDOM}
fix 5 all langevin 2000 2000 0.01 ${RANDOM}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.55 | 3.55 | 3.55 Mbytes
Step Temp f_avt TotEng f_avE Volume f_avv Press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6] f_avpxx2 
       0    1998.4843            0   -6678.3317            0    23887.872            0    137357.09            0            0            0            0            0            0            0 
     100    1993.7784     2008.793    -6679.503   -6684.8296    23887.872    23887.872    137218.97    134191.66    133339.66    138850.71   -2754.1745   -88.701789   -2004.1837 1.8009167e+10 
     200    1966.1538    2007.2964   -6677.6135   -6671.2385    23887.872    23887.872    139339.62    135871.29     139448.2     140882.6   -1863.4558    329.50711   -375.26873 1.8463117e+10 
     300    2022.2213    2026.8425    -6659.268   -6657.1365    23887.872    23887.872    140122.75    137925.04    140507.06    143417.87   -1135.2616   -477.65499    474.07217 1.9026508e+10 
Loop time of 1.5702 on 1 procs for 300 steps with 2048 atoms

Performance: 16.507 ns/day, 1.454 hours/ns, 191.058 timesteps/s
100.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.4388     | 1.4388     | 1.4388     |   0.0 | 91.63
Neigh   | 0.096521   | 0.096521   | 0.096521   |   0.0 |  6.15
Comm    | 0.0061523  | 0.0061523  | 0.0061523  |   0.0 |  0.39
Output  | 7.7674e-05 | 7.7674e-05 | 7.7674e-05 |   0.0 |  0.00
Modify  | 0.026518   | 0.026518   | 0.026518   |   0.0 |  1.69
Other   |            | 0.002086   |            |       |  0.13

Nlocal:    2048 ave 2048 max 2048 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    4227 ave 4227 max 4227 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    123032 ave 123032 max 123032 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 123032
Ave neighs/atom = 60.0742
Neighbor list builds = 20
Dangerous builds = 0

variable pxx0 equal f_avp[1]
variable pyy0 equal f_avp[2]
variable pzz0 equal f_avp[3]
variable pxy0 equal f_avp[4]
variable pxz0 equal f_avp[5]
variable pyz0 equal f_avp[6]

variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 28.8
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 28.8
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 28.8

# These formulas define the derivatives w.r.t. strain components
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-137925.042048253)/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-137925.042048253)/(v_delta/v_len0)*0.0001
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-140507.064650599)/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-140507.064650599)/(v_delta/v_len0)*0.0001
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-143417.871921684)/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-143417.871921684)/(v_delta/v_len0)*0.0001
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-474.072171156174)/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-474.072171156174)/(v_delta/v_len0)*0.0001
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1--477.654992464044)/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1--477.654992464044)/(v_delta/v_len0)*0.0001
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--1135.26161367485)/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--1135.26161367485)/(v_delta/v_len0)*0.0001

# Write restart
write_restart restart.equil

# uxx Perturbation

variable dir equal 1
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 28.8
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:87)
  using 1 OpenMP thread(s) per MPI task
box tilt large
read_restart restart.equil
  restoring atom style atomic from restart
  triclinic box = (0 0 0) to (28.8 28.8 28.8) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
  pair style eam/alloy stores no restart info
  2048 atoms
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

reset_timestep 0

# Choose potential
pair_style	eam/alloy
pair_coeff 	* * CuNi.eam.alloy Ni Cu
Reading potential file CuNi.eam.alloy with DATE: 2014-07-11


# Setup neighbor style

neighbor	0.5 bin
neigh_modify delay 10 check yes

# Setup output
variable energy equal etotal
variable volume equal vol
variable pxx2 equal "c_thermo_press[1]^2"
fix avp all ave/time ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time 10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time 10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time 10 10 100 c_thermo_press mode vector
fix avE all ave/time ${nevery} ${nrepeat} ${nfreq} v_energy mode scalar
fix avE all ave/time 10 ${nrepeat} ${nfreq} v_energy mode scalar
fix avE all ave/time 10 10 ${nfreq} v_energy mode scalar
fix avE all ave/time 10 10 100 v_energy mode scalar
fix avv all ave/time ${nevery} ${nrepeat} ${nfreq} v_volume mode scalar
fix avv all ave/time 10 ${nrepeat} ${nfreq} v_volume mode scalar
fix avv all ave/time 10 10 ${nfreq} v_volume mode scalar
fix avv all ave/time 10 10 100 v_volume mode scalar
fix avt all ave/time ${nevery} ${nrepeat} ${nfreq} c_thermo_temp mode scalar
fix avt all ave/time 10 ${nrepeat} ${nfreq} c_thermo_temp mode scalar
fix avt all